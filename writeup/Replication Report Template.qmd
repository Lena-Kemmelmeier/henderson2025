---
title: "Replication of Henderson et al. (2025, Nature Communications)"
author: "Lena L. Kemmelmeier (lkemmelmeier@ucsd.edu)"
date: "`r format(Sys.time(), '%B %d, %Y')`"
format:
  html:
    toc: true
    toc_depth: 3
---

<!-- Replication reports should all use this template to standardize reporting across projects.  These reports will be public supplementary materials that accompany the summary report(s) of the aggregate results. -->

## Introduction

Henderson et al. (2025) investigated how representations of shape stimuli in the visual cortex change under different decision rule contexts. Participants categorized novel stimuli along two linear category boundaries and one non-linear category boundary during fMRI sessions. Behavioral (accuracy and reaction time) data and decoding of voxel activation data suggested that sensory shape representations adapted to support the discrimination of relevant categories, with there being more prominent effects for shapes close to the decision boundary.

**Justification**  
I will simulate data, rather than conduct an experiment, as my research does not lend itself to data collection this quarter. The research questions of Henderson et al. (2025) do not directly overlap with my first-year project; however, I chose to work with this study because it was led by former lab members and offers a unique opportunity to get familiar with pipelines and techniques that I may use in future projects, and which are broadly applicable to my research in human visual cognition. In attempting to reproduce a statistical result based on the decoding of voxel activation patterns (crucial to the paper’s main claim), I can gain familiarity with fMRI and classification pipelines. I recognize that simulating fMRI data is a bit unrealistic for the scope of this quarter, so instead, I plan to gain experience generating a new stimulus set and working with vision models like SimCLR and GIST in order to check the structure of the stimuli and their separability across boundaries. Taking these separate routes for the reproducibility check and simulation portions of the project will allow me to gain proficiency in different techniques valuable to my training in the Serences Lab.

**Analyses/Techniques**  

***Reproducing Statistical Result***  
I plan to assess whether I can reproduce the reported Task × Boundary interaction effect on decoding accuracy from the ANOVA that included ROI, Task, and Boundary on voxel activation data. The authors used this significant interaction to support the claim that the structure of category representations (which boundary best separates neural patterns) changes depending on task context. The preprocessed voxel time course data/timing Matlab files for each participant are on OSF, while the Python binary classification script and the script with the ANOVA on decoding accuracies are available on a GitHub repo linked in the paper. Altogether, I anticipate it will be relatively straightforward to test reproducibility, but one potential challenge I foresee is making sure the scripts can run properly (i.e., configuring an environment with the appropriate dependencies), though I do see a link to a `.yml` file for a conda environment, so I am optimistic.

***Simulation***  
I plan to create a new set of 2D stimuli and analyze them using computer vision models like GIST or SimCLR. To create the new silhouette stimuli, I will vary the properties of radial frequency components with custom Matlab scripts (I can refer to the scripts created by the authors and hosted on their GitHub repo as a starting point). The goal will be to make 16 stimuli that continuously vary along the two different dimensions. I will then run these stimuli through GIST and SimCLR (pre-trained versions of SimCLR models can be downloaded online, and GIST scripts can be found in the authors’ repo). Afterward, I will apply principal component analysis (PCA) on the GIST features to visualize and confirm the 2D structure of the stimulus space (I believe this PCA script is also in the repo). I plan to also calculate the category separability across decision boundaries to see if I can recreate the same patterns in the paper, with higher separability for the linear boundaries compared to the non-linear boundary across both models (the methods outline the procedures for this clearly, but I am not sure if the script is publicly available). Here, I think a main challenge will be figuring out how to create the new stimuli – I am not familiar with generating novel stimuli that fit certain parameters of dimensionality. Moreover, although the computer vision models used here are already implemented, I do not have first-hand experience using them.  

**Links**  
- [GitHub Repo](https://github.com/Lena-Kemmelmeier/henderson2025/tree/main)  
- [Original Paper](https://github.com/Lena-Kemmelmeier/henderson2025/tree/main/original_paper)  

## Methods

### Power Analysis

Original effect size, power analysis for samples to achieve 80%, 90%, 95% power to detect that effect size.  Considerations of feasibility for selecting planned sample size.

### Planned Sample

Planned sample size and/or termination rule, sampling frame, known demographics if any, preselection rules if any.

### Materials

All materials - can quote directly from original article - just put the text in quotations and note that this was followed precisely.  Or, quote directly and just point out exceptions to what was described in the original article.

### Procedure	

Can quote directly from original article - just put the text in quotations and note that this was followed precisely.  Or, quote directly and just point out exceptions to what was described in the original article.

### Analysis Plan

Can also quote directly, though it is less often spelled out effectively for an analysis strategy section.  The key is to report an analysis strategy that is as close to the original - data cleaning rules, data exclusion rules, covariates, etc. - as possible.  

**Clarify key analysis of interest here**  You can also pre-specify additional analyses you plan to do.

### Differences from Original Study

Explicitly describe known differences in sample, setting, procedure, and analysis plan from original study.  The goal, of course, is to minimize those differences, but differences will inevitably occur.  Also, note whether such differences are anticipated to make a difference based on claims in the original article or subsequent published research on the conditions for obtaining the effect.

### Methods Addendum (Post Data Collection)

You can comment this section out prior to final report with data collection.

#### Actual Sample
  Sample size, demographics, data exclusions based on rules spelled out in analysis plan

#### Differences from pre-data collection methods plan
  Any differences from what was described as the original plan, or “none”.


## Results


### Data preparation

Data preparation following the analysis plan.
	
```{r include=F}
### Data Preparation

#### Load Relevant Libraries and Functions

#### Import data

#### Data exclusion / filtering

#### Prepare data for analysis - create columns etc.
```

### Confirmatory analysis

The analyses as specified in the analysis plan.  

*Side-by-side graph with original graph is ideal here*

### Exploratory analyses

Any follow-up analyses desired (not required).  

## Discussion

### Summary of Replication Attempt

Open the discussion section with a paragraph summarizing the primary result from the confirmatory analysis and the assessment of whether it replicated, partially replicated, or failed to replicate the original result.  

### Commentary

Add open-ended commentary (if any) reflecting (a) insights from follow-up exploratory analysis, (b) assessment of the meaning of the replication (or not) - e.g., for a failure to replicate, are the differences between original and present study ones that definitely, plausibly, or are unlikely to have been moderators of the result, and (c) discussion of any objections or challenges raised by the current and original authors about the replication attempt.  None of these need to be long.
